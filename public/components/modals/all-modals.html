<!-- –§—ñ–ª—å—Ç—Ä–∏ -->
<div id="filterModal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/30 backdrop-blur-sm transition-opacity" onclick="closeFilterModal()">
    </div>
    <div
        class="absolute bottom-0 left-0 right-0 glass-modal rounded-t-[24px] max-h-[70vh] overflow-y-auto p-4 animate-slide-up shadow-2xl">
        <div class="flex justify-between items-center mb-4 px-2">
            <h3 class="font-bold text-lg">–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫</h3><button onclick="closeFilterModal()"
                class="w-8 h-8 bg-gray-100 dark:bg-[#2C2C2E] rounded-full text-gray-500 text-sm font-bold">‚úï</button>
        </div>
        <div id="filterList" class="space-y-2"></div>
    </div>
</div>

<div id="storeFilterModal" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/30 backdrop-blur-sm transition-opacity" onclick="closeStoreFilterModal()">
    </div>
    <div
        class="absolute bottom-0 left-0 right-0 glass-modal rounded-t-[24px] max-h-[70vh] overflow-y-auto p-4 animate-slide-up shadow-2xl">
        <div class="flex justify-between items-center mb-4 px-2">
            <h3 class="font-bold text-lg">–ú–∞–≥–∞–∑–∏–Ω</h3><button onclick="closeStoreFilterModal()"
                class="w-8 h-8 bg-gray-100 dark:bg-[#2C2C2E] rounded-full text-gray-500 text-sm font-bold">‚úï</button>
        </div>
        <div id="storeFilterList" class="space-y-2"></div>
    </div>
</div>

<!-- –ü—Ä–æ—Ñ—ñ–ª—å -->
<div id="avatarModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-md" onclick="closeAvatarModal()"></div>
    <div class="glass-modal rounded-2xl w-full max-w-sm p-6 relative z-10 text-center animate-slide-up">
        <h3 class="font-bold text-xl mb-4">–í–∞—à–µ —Ñ–æ—Ç–æ</h3>
        <div class="avatar-preview-container mb-6 shadow-xl"><img id="avatarPreview" class="avatar-preview-img hidden">
            <div id="avatarPlaceholder" class="w-full h-full flex items-center justify-center text-4xl text-gray-400">üì∑
            </div>
        </div><label class="btn-primary block mb-3 cursor-pointer shadow-lg shadow-blue-500/30">–û–±—Ä–∞—Ç–∏ –Ω–æ–≤–µ
            —Ñ–æ—Ç–æ<input type="file" id="avatarInput" accept="image/*" class="hidden"
                onchange="handleAvatarSelect(this)"></label>
        <div id="avatarActions" class="hidden space-y-2"><button onclick="uploadAvatar()"
                class="btn-primary bg-green-500 shadow-green-500/30">–ó–±–µ—Ä–µ–≥—Ç–∏</button><button
                onclick="closeAvatarModal()" class="w-full py-3 text-red-500 font-medium">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
        <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800"><button onclick="openChangePasswordModal()"
                class="w-full py-2 text-blue-500 font-medium text-sm rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">üîê
                –ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å</button></div>
    </div>
</div>

<div id="changePasswordModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-md" onclick="closeChangePasswordModal()"></div>
    <div class="glass-modal rounded-2xl w-full max-w-sm p-6 relative z-10 animate-slide-up text-center">
        <h3 class="font-bold text-xl mb-4">üîê –ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3><input type="password" id="oldPassword"
            placeholder="–°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å" class="ios-input mb-3"><input type="password" id="newPassword"
            placeholder="–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å" class="ios-input mb-3"><input type="password" id="confirmPassword"
            placeholder="–ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å" class="ios-input mb-4"><button onclick="submitChangePassword()"
            class="btn-primary bg-indigo-500 shadow-indigo-500/30 mb-2">–ó–º—ñ–Ω–∏—Ç–∏</button><button
            onclick="closeChangePasswordModal()" class="w-full py-3 text-red-500 font-medium">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
</div>

<!-- –ù–æ—Ç–∞—Ç–∫–∏ —Ç–∞ –ó–∞–¥–∞—á—ñ -->
<div id="notesModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-md" onclick="closeNotesModal()"></div>
    <div class="glass-modal rounded-2xl w-full max-w-sm p-5 relative z-10 animate-slide-up">
        <div class="flex justify-between items-center mb-4">
            <h3 class="font-bold text-lg" id="notesModalTitle">–ù–æ—Ç–∞—Ç–∫–∏</h3><button onclick="closeNotesModal()"
                class="text-gray-400 text-2xl">√ó</button>
        </div>
        <div id="notesList" class="space-y-2 mb-4 max-h-48 overflow-y-auto"></div>
        <div class="border-t border-gray-100 dark:border-gray-800 pt-4"><textarea id="newNoteText"
                placeholder="–ù–∞–ø–∏—à—ñ—Ç—å —â–æ—Å—å..." class="ios-input h-20 text-sm mb-3"></textarea>
            <div class="flex gap-2">
                <div id="noteTypeToggle"
                    class="hidden items-center gap-2 bg-[#E5E5EA] dark:bg-[#2C2C2E] px-3 rounded-lg cursor-pointer active:scale-95 transition-transform"
                    onclick="toggleNoteType()"><span id="noteTypeIcon">üîí</span> <span class="text-xs font-bold"
                        id="noteTypeLabel">–û—Å–æ–±–∏—Å—Ç–∞</span></div><button onclick="saveNote()"
                    class="btn-primary flex-1">–î–æ–¥–∞—Ç–∏</button>
            </div>
        </div>
    </div>
</div>

<div id="taskDetailsModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-md" onclick="closeTaskDetailsModal()"></div>
    <div class="glass-modal rounded-2xl w-full max-w-sm p-6 relative z-10 animate-slide-up">
        <div class="flex justify-between items-start mb-4">
            <h3 class="font-bold text-xl leading-tight pr-4" id="taskModalTitle">Task Title</h3>
            <button onclick="closeTaskDetailsModal()" class="text-gray-400 text-2xl leading-none">&times;</button>
        </div>
        <div class="space-y-3 mb-6">
            <div class="flex items-center gap-3 text-sm text-gray-600 dark:text-gray-300">
                <span class="text-lg">üìÖ</span>
                <span id="taskModalDate" class="font-medium">Date</span>
            </div>
            <div class="flex items-center gap-3 text-sm text-gray-600 dark:text-gray-300">
                <span class="text-lg">‚è∞</span>
                <span id="taskModalTime" class="font-medium">Time</span>
            </div>
            <div class="flex items-center gap-3 text-sm text-gray-600 dark:text-gray-300">
                <span class="text-lg">üë§</span>
                <span id="taskModalUser" class="font-medium">User</span>
            </div>
            <div id="taskModalDescriptionWrapper"
                class="hidden mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
                <div class="text-xs font-bold text-gray-400 mb-1 uppercase">–û–ø–∏—Å</div>
                <div id="taskModalDescription"
                    class="text-sm text-gray-800 dark:text-gray-200 break-words whitespace-pre-wrap leading-relaxed">
                </div>
            </div>
        </div>
        <button id="btnToggleTaskStatus"
            class="w-full py-3 text-white font-bold bg-green-500 rounded-xl active:scale-95 transition-transform mb-2">‚úÖ
            –í—ñ–¥–º—ñ—Ç–∏—Ç–∏ —è–∫ –≤–∏–∫–æ–Ω–∞–Ω—É</button>
        <button id="btnDeleteTask"
            class="w-full py-3 text-red-500 font-bold bg-red-50 dark:bg-red-900/20 rounded-xl active:scale-95 transition-transform">üóë
            –í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–¥–∞—á—É</button>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤–∏–±–æ—Ä—É –°–≤–æ—î—ó –ó–º—ñ–Ω–∏ (Custom Shift) -->
<div id="customShiftModal"
    class="hidden fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
    <div class="ios-card w-full max-w-sm p-6 transform scale-95 transition-transform duration-300 shadow-2xl relative">
        <h2 class="text-xl font-bold mb-1 text-gray-900 dark:text-white">–°–≤–æ—è –ó–º—ñ–Ω–∞</h2>
        <p class="text-sm text-gray-500 mb-6">–í–∫–∞–∂—ñ—Ç—å —á–∞—Å –ø–æ—á–∞—Ç–∫—É —Ç–∞ –∫—ñ–Ω—Ü—è</p>

        <div class="flex items-center gap-4 mb-6">
            <div class="flex-1">
                <label class="block text-xs font-bold text-gray-400 uppercase mb-1">–ü–æ—á–∞—Ç–æ–∫</label>
                <input type="time" id="customShiftStart" class="ios-input w-full text-center text-lg font-bold">
            </div>
            <div class="text-gray-400 font-bold mt-4">-</div>
            <div class="flex-1">
                <label class="block text-xs font-bold text-gray-400 uppercase mb-1">–ö—ñ–Ω–µ—Ü—å</label>
                <input type="time" id="customShiftEnd" class="ios-input w-full text-center text-lg font-bold">
            </div>
        </div>

        <div class="flex gap-3">
            <button onclick="window.closeCustomShiftModal()"
                class="flex-1 py-3 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-xl font-bold active:scale-95 transition-transform">
                –°–∫–∞—Å—É–≤–∞—Ç–∏
            </button>
            <button onclick="window.applyCustomShiftTime()"
                class="flex-1 py-3 bg-blue-500 text-white rounded-xl font-bold active:scale-95 transition-transform shadow-lg shadow-blue-500/30">
                –ì–æ—Ç–æ–≤–æ
            </button>
        </div>
    </div>
</div>

<div id="contextMenu"
    class="hidden fixed z-[100] w-48 bg-white dark:bg-[#1C1C1E] rounded-xl shadow-2xl ring-1 ring-black/5 dark:ring-white/10 overflow-hidden transform transition-all origin-top-left">
    <div class="p-1 space-y-0.5">
        <button id="ctxEdit"
            class="w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2C2C2E] rounded-lg flex items-center gap-2">
            <span>‚úèÔ∏è</span> –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
        </button>
        <button id="ctxCopy"
            class="w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2C2C2E] rounded-lg flex items-center gap-2">
            <span>üìã</span> –ö–æ–ø—ñ—é–≤–∞—Ç–∏
        </button>
        <div class="h-px bg-gray-200 dark:bg-gray-700 my-1"></div>
        <button id="ctxDelete"
            class="w-full text-left px-3 py-2 text-sm text-red-500 font-medium hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg flex items-center gap-2">
            <span>üóë</span> –í–∏–¥–∞–ª–∏—Ç–∏
        </button>
    </div>
</div>

<div
    class="hidden ring-2 ring-blue-500 shadow-lg shadow-blue-500/20 dark:shadow-blue-500/50 dark:shadow-blue-500 sticky left-0 z-10 z-20 min-w-[100px] min-w-[40px] border-r border-b opacity-80 bg-blue-50/50 dark:bg-blue-900/10 border-x-2 border-blue-200 dark:border-blue-800">
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–¥–∞—á—ñ -->
<div id="addTaskModal"
    class="hidden fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0" onclick="window.closeAddTaskModal()"></div>
    <div class="ios-card w-full max-w-sm p-6 relative z-10 animate-slide-up">
        <div class="flex items-center justify-between mb-4">
            <h3 class="font-bold text-xl">üìå –ù–æ–≤–∞ –∑–∞–¥–∞—á–∞</h3>
            <button onclick="window.closeAddTaskModal()" class="text-gray-400 text-2xl leading-none">&times;</button>
        </div>
        <div class="space-y-3">
            <input type="text" id="taskTitle" placeholder="–ù–∞–∑–≤–∞ (–∫–æ—Ä–æ—Ç–∫–æ)" class="ios-input font-bold">
            <div class="grid grid-cols-2 gap-3">
                <input type="date" id="taskDate" class="ios-input">
                <select id="taskEmployee" class="ios-input bg-transparent">
                    <option disabled selected>–ö–æ–º—É?</option>
                </select>
            </div>
            <textarea id="taskDescription" placeholder="–û–ø–∏—Å (–ø–æ—Å–∏–ª–∞–Ω–Ω—è, –¥–µ—Ç–∞–ª—ñ...)"
                class="ios-input h-20 text-sm"></textarea>
            <div class="flex items-center justify-between px-1">
                <span class="text-sm font-medium">–í–µ—Å—å –¥–µ–Ω—å</span>
                <input type="checkbox" id="taskFullDay" onchange="toggleTaskTimeInputs()"
                    class="w-5 h-5 accent-purple-500">
            </div>
            <div id="taskTimeInputs" class="flex gap-3">
                <input type="time" id="taskStart" class="ios-input" value="12:00">
                <input type="time" id="taskEnd" class="ios-input" value="14:00">
            </div>
            <button onclick="addTask()" class="btn-primary bg-purple-500 shadow-purple-500/30 mt-2">–ü—Ä–∏–∑–Ω–∞—á–∏—Ç–∏</button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –Ω–æ–≤–∏–Ω–∏ -->
<div id="addNewsModal"
    class="hidden fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0" onclick="window.closeAddNewsModal()"></div>
    <div class="ios-card w-full max-w-sm p-6 relative z-10 animate-slide-up">
        <div class="flex items-center justify-between mb-4">
            <h3 class="font-bold text-xl">üì¢ –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–Ω—É</h3>
            <button onclick="window.closeAddNewsModal()" class="text-gray-400 text-2xl leading-none">&times;</button>
        </div>
        <div class="space-y-3">
            <div class="flex gap-2 mb-1 overflow-x-auto pb-1">
                <button onclick="formatText('bold')"
                    class="bg-gray-200 dark:bg-[#3A3A3C] px-3 py-1 rounded-lg text-xs font-bold">B</button>
                <button onclick="formatText('italic')"
                    class="bg-gray-200 dark:bg-[#3A3A3C] px-3 py-1 rounded-lg text-xs italic">I</button>
                <button onclick="formatText('link')"
                    class="bg-gray-200 dark:bg-[#3A3A3C] px-3 py-1 rounded-lg text-xs">üîó</button>
            </div>
            <textarea id="newsText" placeholder="–¢–µ–∫—Å—Ç –Ω–æ–≤–∏–Ω–∏..." class="ios-input h-32 text-sm"></textarea>
            <div class="flex items-center justify-between px-1">
                <span class="text-sm font-medium text-gray-500">–ö–Ω–æ–ø–∫–∞ "–û–∑–Ω–∞–π–æ–º–∏–≤—Å—è"</span>
                <input type="checkbox" id="newsRequestRead" class="w-5 h-5 accent-pink-500 rounded" checked>
            </div>
            <label
                class="flex-1 flex items-center justify-center gap-2 bg-[#E5E5EA] dark:bg-[#2C2C2E] p-3 rounded-xl cursor-pointer hover:opacity-80 transition-opacity mt-2 border border-dashed border-gray-300 dark:border-gray-700">
                <span class="text-xl">üìé</span>
                <span id="fileName" class="text-xs truncate text-gray-500">–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ/—Ñ–∞–π–ª</span>
                <input type="file" id="newsFile" class="hidden" multiple onchange="updateFileName()">
            </label>
            <button onclick="publishNews()"
                class="btn-primary bg-pink-500 mt-2 shadow-pink-500/30">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞–≥–∞–∑–∏–Ω—É -->
<div id="addStoreModal"
    class="hidden fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0" onclick="window.closeAddStoreModal()"></div>
    <div class="ios-card w-full max-w-sm p-6 relative z-10 animate-slide-up">
        <div class="flex items-center justify-between mb-4">
            <h3 class="font-bold text-xl">üè™ –î–æ–¥–∞—Ç–∏ –º–∞–≥–∞–∑–∏–Ω</h3>
            <button onclick="window.closeAddStoreModal()" class="text-gray-400 text-2xl leading-none">&times;</button>
        </div>
        <div class="space-y-3">
            <input type="text" id="newStoreName" placeholder="–ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä. Space Lviv)" class="ios-input">
            <input type="text" id="newStoreCode" placeholder="–ö–æ–¥ (–Ω–∞–ø—Ä. iqos_lviv)" class="ios-input">
            <select id="newStoreType" class="ios-input bg-transparent">
                <option value="top">–¢–û–ü</option>
                <option value="kiev">–ö–∏—ó–≤</option>
                <option value="expansion">–ï–∫—Å–ø–∞–Ω—Å—ñ—è</option>
                <option value="standard">–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
            </select>
            <button onclick="createStore()" class="btn-primary bg-blue-600 shadow-blue-600/30 mt-2">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
        </div>
    </div>
</div>